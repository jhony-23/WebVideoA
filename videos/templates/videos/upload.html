{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Panel de Mercadotecnia</title>
    <link rel="stylesheet" href="{% static 'videos/css/upload.css' %}">
</head>

<body>
    <header>
        <h1>Panel de Mercadotecnia ADICLA</h1>
    </header>

    <main>
        <!-- FORMULARIO -->
        <section class="form-section">
            <h2>Subir Video</h2>
            <form method="post" enctype="multipart/form-data" class="upload-form">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-primary">üì§ Subir</button>
            </form>
        </section>

        <!-- LISTA DE VIDEOS -->
        <section class="videos-section">
            <h2>Videos Subidos</h2>
            <div class="video-grid">
                {% for video in videos %}
                <div class="video-card">


                    <!-- Info -->
                    <div class="video-info">
                        <h3>{{ video.title }}</h3>
                        <p class="date">{{ video.uploaded_at|date:"d M Y H:i" }}</p>
                    </div>

                    <!-- Acciones -->
                    <div class="video-actions">
                        <a href="{% url 'edit_video' video.id %}" class="btn btn-edit">‚úèÔ∏è Editar</a>
                        <button type="button" class="btn btn-delete" data-video-id="{{ video.id }}"
                            data-video-title="{{ video.title }}">üóëÔ∏è Eliminar</button>
                    </div>
                </div>
                {% empty %}
                <p>No hay videos</p>
                {% endfor %}
            </div>
        </section>
    </main>

    <!-- Modal de confirmaci√≥n -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h2>Confirmar eliminaci√≥n</h2>
            <p id="modal-text"></p>
            <div class="modal-actions">
                <form id="deleteForm" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-delete">‚úÖ S√≠, eliminar</button>
                </form>
                <button type="button" class="btn btn-cancel" id="cancelDelete">‚ùå Cancelar</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const modal = document.getElementById("confirmModal");
            const modalText = document.getElementById("modal-text");
            const cancelBtn = document.getElementById("cancelDelete");
            const deleteForm = document.getElementById("deleteForm");

            // Evento en botones de eliminar
            const deleteButtons = document.querySelectorAll(".btn-delete[data-video-id]");
            deleteButtons.forEach(btn => {
                btn.addEventListener("click", function () {
                    const videoId = this.dataset.videoId;
                    const videoTitle = this.dataset.videoTitle;

                    modalText.textContent = `¬øSeguro que quieres eliminar el video "${videoTitle}"?`;
                    deleteForm.action = `/delete/${videoId}/`;
                    modal.style.display = "flex";
                });
            });

            // Cancelar
            cancelBtn.addEventListener("click", function () {
                modal.style.display = "none";
            });
        });
    </script>

    <!-- FOOTER -->
    <footer>
        <p>¬© 2025 Sitio Web ADICLA Mercadotecnia y Publicidad. Todos los derechos reservados.</p>
    </footer>
</body>

</html>