<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eliminar Proyecto - ADICLA</title>
    {% load static %}
    <link rel="icon" type="image/png" href="{% static 'videos/img/favicon_institucion.png' %}?v=5">
    <link rel="stylesheet" href="{% static 'videos/css/tareas_dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'videos/css/landing.css' %}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="header-title">üóëÔ∏è Eliminar Proyecto - ADICLA</h1>
            <div class="user-info">
                <span class="user-welcome">üëã {{ user.first_name|default:user.username }}</span>
                <a href="{% url 'tareas_dashboard' %}" class="btn-logout">üè† Dashboard</a>
                <a href="{% url 'tareas_logout' %}" class="btn-logout">üö™ Cerrar Sesi√≥n</a>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Navigation Bar -->
        <section class="actions-bar">
            <div class="actions-left">
                <nav class="breadcrumb">
                    <a href="{% url 'tareas_dashboard' %}">Dashboard</a> &gt;
                    <a href="{% url 'proyectos_lista' %}">Proyectos</a> &gt;
                    <a href="{% url 'proyecto_detalle' proyecto.pk %}">{{ proyecto.nombre }}</a> &gt;
                    <span>Eliminar</span>
                </nav>
            </div>
            <div class="actions-right">
                <a href="{% url 'proyecto_detalle' proyecto.pk %}" class="btn-secondary">‚Ü©Ô∏è Volver</a>
            </div>
        </section>

        <!-- Confirmation Form -->
        <section class="form-section">
            <div class="form-container">
                <div class="form-header">
                    <h1>üö® ¬øEst√°s seguro de eliminar este proyecto?</h1>
                    <p style="color: #ef4444; font-weight: 600;">Esta acci√≥n no se puede deshacer</p>
                </div>

                <!-- Project Info -->
                <div class="project-info-box" style="background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 30px; margin: 30px 0;">
                    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
                        <div style="font-size: 3rem;">{{ proyecto.icono }}</div>
                        <div>
                            <h2 style="color: #991b1b; margin: 0 0 5px 0;">{{ proyecto.nombre }}</h2>
                            <p style="color: #7f1d1d; margin: 0; font-weight: 600;">{{ proyecto.codigo }}</p>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h3 style="color: #991b1b; margin: 0 0 10px 0;">üìä Informaci√≥n del Proyecto</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9rem;">
                            <div><strong>Estado:</strong> {{ proyecto.get_estado_display }}</div>
                            <div><strong>Creado:</strong> {{ proyecto.created_at|date:"d/m/Y" }}</div>
                            <div><strong>Tareas totales:</strong> {{ proyecto.tareas.count }}</div>
                            <div><strong>Miembros:</strong> {{ proyecto.miembros.count }}</div>
                        </div>
                    </div>

                    {% if proyecto.tareas.exists %}
                    <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border: 1px solid #fecaca;">
                        <h4 style="color: #991b1b; margin: 0 0 10px 0;">‚ö†Ô∏è Este proyecto contiene {{ proyecto.tareas.count }} tarea{{ proyecto.tareas.count|pluralize }}</h4>
                        <p style="color: #7f1d1d; margin: 0; font-size: 0.9rem;">Al eliminar el proyecto, tambi√©n se eliminar√°n todas las tareas asociadas.</p>
                    </div>
                    {% endif %}
                </div>

                <!-- Confirmation Form -->
                <form method="post">
                    {% csrf_token %}
                    
                    <div style="background: #f9fafb; padding: 25px; border-radius: 12px; border: 2px solid #e5e7eb; margin-bottom: 30px;">
                        <h3 style="color: #374151; margin: 0 0 15px 0;">‚úçÔ∏è Confirmaci√≥n requerida</h3>
                        <p style="color: #6b7280; margin-bottom: 15px;">
                            Para confirmar que deseas eliminar este proyecto, escribe <strong>"{{ proyecto.nombre }}"</strong> en el campo de abajo:
                        </p>
                        <input type="text" 
                               name="confirmacion" 
                               placeholder="Escribe el nombre del proyecto aqu√≠" 
                               required
                               style="width: 100%; padding: 12px 15px; border: 2px solid #d1d5db; border-radius: 8px; font-size: 1rem;"
                               autocomplete="off">
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions" style="display: flex; gap: 15px; justify-content: flex-end;">
                        <a href="{% url 'proyecto_detalle' proyecto.pk %}" class="btn-secondary" style="padding: 12px 24px;">
                            ‚Ü©Ô∏è Cancelar
                        </a>
                        <button type="submit" class="btn-danger" style="background: #ef4444; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            üóëÔ∏è Eliminar Proyecto
                        </button>
                    </div>
                </form>

                <!-- Warning Box -->
                <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; margin-top: 30px;">
                    <h4 style="color: #92400e; margin: 0 0 10px 0;">‚ö†Ô∏è Importante</h4>
                    <ul style="color: #92400e; margin: 0; padding-left: 20px;">
                        <li>Esta acci√≥n eliminar√° permanentemente el proyecto</li>
                        <li>Todas las tareas asociadas ser√°n eliminadas</li>
                        <li>Los archivos y datos del proyecto no se pueden recuperar</li>
                        <li>Los miembros del proyecto perder√°n acceso inmediatamente</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Validaci√≥n del formulario
        document.querySelector('form').addEventListener('submit', function(e) {
            const confirmacion = document.querySelector('input[name="confirmacion"]').value;
            const nombreProyecto = "{{ proyecto.nombre }}";
            
            if (confirmacion !== nombreProyecto) {
                e.preventDefault();
                alert('‚ùå El nombre del proyecto no coincide. Por favor, escribe exactamente: "' + nombreProyecto + '"');
                return false;
            }
            
            // Confirmaci√≥n final
            if (!confirm('‚ö†Ô∏è ¬øEst√°s absolutamente seguro de que deseas eliminar este proyecto? Esta acci√≥n NO se puede deshacer.')) {
                e.preventDefault();
                return false;
            }
        });

        // Estilo hover para el bot√≥n de eliminar
        const btnEliminar = document.querySelector('.btn-danger');
        if (btnEliminar) {
            btnEliminar.addEventListener('mouseenter', function() {
                this.style.background = '#dc2626';
                this.style.transform = 'translateY(-2px)';
                this.style.boxShadow = '0 8px 25px rgba(239, 68, 68, 0.3)';
            });
            
            btnEliminar.addEventListener('mouseleave', function() {
                this.style.background = '#ef4444';
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = 'none';
            });
        }
    </script>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    {% load static %}
                    <img src="{% static 'videos/img/logo-adicla.png' %}" alt="ADICLA Logo" class="footer-logo">
                    <h3>ADICLA</h3>
                    <p>Tu instituci√≥n financiera de confianza</p>
                </div>
                
                <div class="footer-contact">
                    <h4>Contacto</h4>
                    <p>üìç Solola</p>
                    <p>üìç 6a. Avenida 6-30 zona 1 Barrio San Antonio, Solol√°</p>
                    <p>üìû PBX (502) 7955-2500</p>
                    <p>‚úâÔ∏è www.adicla.org.gt</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 ADICLA - Asociaci√≥n de Desarrollo Integral Cuenca del Lago de Atitl√°n. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>
</body>
</html>